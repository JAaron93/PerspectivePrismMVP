<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Options Validation</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .test-case {
            margin-bottom: 15px;
            padding: 10px;
            background: #f5f5f5;
            border-radius: 4px;
        }
        .result {
            margin-top: 5px;
            padding: 5px;
            border-radius: 3px;
        }
        .pass {
            background: #d4edda;
            color: #155724;
        }
        .fail {
            background: #f8d7da;
            color: #721c24;
        }
        button {
            padding: 10px 20px;
            background: #2196f3;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background: #1976d2;
        }
    </style>
</head>
<body>
    <h1>Options Validation Test Suite</h1>
    
    <div class="test-section">
        <h2>Backend URL Validation Tests</h2>
        <div id="url-tests"></div>
    </div>

    <div class="test-section">
        <h2>Cache Duration Validation Tests</h2>
        <div id="duration-tests"></div>
    </div>

    <button onclick="runAllTests()">Run All Tests</button>

    <script src="config.js"></script>
    <script>
        // Test cases for URL validation
        const urlTestCases = [
            { url: 'https://api.example.com', expected: true, description: 'Valid HTTPS URL' },
            { url: 'http://localhost:8000', expected: true, description: 'Valid localhost HTTP URL' },
            { url: 'http://127.0.0.1:8000', expected: true, description: 'Valid 127.0.0.1 HTTP URL' },
            { url: 'http://example.com', expected: false, description: 'Invalid: HTTP for non-localhost' },
            { url: 'ftp://example.com', expected: false, description: 'Invalid: FTP protocol' },
            { url: 'not-a-url', expected: false, description: 'Invalid: Not a URL' },
            { url: '', expected: false, description: 'Invalid: Empty string' },
            { url: 'https://api.example.com:8443', expected: true, description: 'Valid HTTPS with port' },
            { url: 'https://api.example.com/path', expected: true, description: 'Valid HTTPS with path' },
        ];

        // Test cases for cache duration validation
        const durationTestCases = [
            { duration: 24, expected: true, description: 'Valid: 24 hours' },
            { duration: 1, expected: true, description: 'Valid: 1 hour (minimum)' },
            { duration: 168, expected: true, description: 'Valid: 168 hours (maximum)' },
            { duration: 0, expected: false, description: 'Invalid: 0 hours (below minimum)' },
            { duration: 169, expected: false, description: 'Invalid: 169 hours (above maximum)' },
            { duration: -1, expected: false, description: 'Invalid: Negative number' },
            { duration: 'abc', expected: false, description: 'Invalid: Not a number' },
        ];

        function runAllTests() {
            runUrlTests();
            runDurationTests();
        }

        function runUrlTests() {
            const container = document.getElementById('url-tests');
            container.innerHTML = '';

            urlTestCases.forEach((testCase, index) => {
                const result = ConfigValidator.isValidUrl(testCase.url, false);
                const passed = result === testCase.expected;

                const testDiv = document.createElement('div');
                testDiv.className = 'test-case';
                testDiv.innerHTML = `
                    <strong>Test ${index + 1}:</strong> ${testCase.description}<br>
                    <strong>Input:</strong> "${testCase.url}"<br>
                    <strong>Expected:</strong> ${testCase.expected}<br>
                    <strong>Actual:</strong> ${result}<br>
                    <div class="result ${passed ? 'pass' : 'fail'}">
                        ${passed ? '✓ PASS' : '✗ FAIL'}
                    </div>
                `;
                container.appendChild(testDiv);
            });
        }

        function runDurationTests() {
            const container = document.getElementById('duration-tests');
            container.innerHTML = '';

            durationTestCases.forEach((testCase, index) => {
                const duration = parseInt(testCase.duration, 10);
                const result = !isNaN(duration) && duration >= 1 && duration <= 168;
                const passed = result === testCase.expected;

                const testDiv = document.createElement('div');
                testDiv.className = 'test-case';
                testDiv.innerHTML = `
                    <strong>Test ${index + 1}:</strong> ${testCase.description}<br>
                    <strong>Input:</strong> ${testCase.duration}<br>
                    <strong>Expected:</strong> ${testCase.expected}<br>
                    <strong>Actual:</strong> ${result}<br>
                    <div class="result ${passed ? 'pass' : 'fail'}">
                        ${passed ? '✓ PASS' : '✗ FAIL'}
                    </div>
                `;
                container.appendChild(testDiv);
            });
        }

        // Run tests on page load
        window.addEventListener('DOMContentLoaded', runAllTests);
    </script>
</body>
</html>
